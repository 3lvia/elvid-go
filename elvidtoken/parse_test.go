package elvidtoken

import "testing"

const tokenString = `eyJhbGciOiJSUzI1NiIsImtpZCI6IkQ3MjY1QkUyNUFGODcxQUVDQTI1REQ2MTY2OTY2QzE5NTVFMzQ3QTRSUzI1NiIsIng1dCI6IjF5WmI0bHI0Y2E3S0pkMWhacFpzR1ZYalI2USIsInR5cCI6ImF0K2p3dCJ9.eyJpc3MiOiJodHRwczovL2VsdmlkLnRlc3QtZWx2aWEuaW8iLCJuYmYiOjE2NzEzNTg1NzksImlhdCI6MTY3MTM1ODU3OSwiZXhwIjoxNjcxMzYyMTc5LCJzY29wZSI6WyJoZXMtZXh0ZW5zaW9ucy5tYWNoaW5lYWNjZXNzIl0sImNsaWVudF9pZCI6IjA5NTU3Y2M1LWE4OWEtNGY2YS1hYzUyLWRlOTVlMzFmOGRiYSIsImNsaWVudF9uYW1lIjoiaGVzLWV4dGVuc2lvbnMtZXZlbnRzLWFwaS10ZXN0Y2xpZW50IChkZXYpIn0.mdTrF6rAda29AU40XQVGyT4AVyGUtVkjOSTyGdDYtDJPAMuD7-vlHrDH8EGHSuXh5925NcY9WKZDsRqoPOR68RBw_0-9M-HhQKzdnqUZdR2xU43tSSx30ZJ7pjrgTA1GDzD3RnZZsoRAj4_w7OB5arZisCCRH2iw1Ps3dMDkfM4oGEU2vatlinJicQRFT9EmUSNy7SKIiQoRZQCFNc2lbI57LFhSBcYHH2g4AplQ7IwBWW6n8ZLckvJbh7_7vl1FJNPNy_m16S40Fa_Zcz3A61TjxgVHsLy3xhGanY8fhW84OcOKRdt3rqoDi-NfoQ0U0apNPoJxyo-r9_IA_CLcLA`
const jwkString = `{"keys":[{"kty":"RSA","use":"sig","kid":"D7265BE25AF871AECA25DD6166966C1955E347A4RS256","x5t":"1yZb4lr4ca7KJd1hZpZsGVXjR6Q","e":"AQAB","n":"wYuqqt1Guw8vt9Do8H2mZshaMXNerF6c9kNoamfqr64mdJ0kGYJw5xO4nM-FpB50S-YgdXq_RF6iiYMCd4tv72_dkDXpTzKThhbkbnuHfwSP-zoWIE18gakwK5O3UdJ5ADLI5EOQO7aF1kdzQN-chsSRw9orEj4uJCc6TsQr9Vl9bnFbvbHuopY_knqAnRBeObswybXCYy-plfsbY2RJ5M4eYTsYOZGwXPG_sfJPai4GQd846cXZn29-Z7VW5Ienq_Y0flsIEuDT-FQ2PocTsbOOMqBq1_ex1t9Wv3BbeQx22qGW5QZ6SkXgouc8QfhYT1UAtS19BBIfGfUQkyAFyw","x5c":["MIIEFTCCAv2gAwIBAgIJAL92YTdfSzEqMA0GCSqGSIb3DQEBCwUAMIGgMQswCQYDVQQGEwJOTzENMAsGA1UECAwET1NMTzENMAsGA1UEBwwET1NMTzEWMBQGA1UECgwNSGFmc2x1bmQgTmV0dDEWMBQGA1UECwwNSGFmc2x1bmQgTmV0dDEWMBQGA1UEAwwNSGFmc2x1bmQgTmV0dDErMCkGCSqGSIb3DQEJARYcZXJpay5maWxsaXBzdmVlbkBoYWZzbHVuZC5ubzAeFw0xODExMTMxNjM5NDFaFw0yNDA1MDUxNjM5NDFaMIGgMQswCQYDVQQGEwJOTzENMAsGA1UECAwET1NMTzENMAsGA1UEBwwET1NMTzEWMBQGA1UECgwNSGFmc2x1bmQgTmV0dDEWMBQGA1UECwwNSGFmc2x1bmQgTmV0dDEWMBQGA1UEAwwNSGFmc2x1bmQgTmV0dDErMCkGCSqGSIb3DQEJARYcZXJpay5maWxsaXBzdmVlbkBoYWZzbHVuZC5ubzCCASIwDQYJKoZIhvcNAQEBBQADggEPADCCAQoCggEBAMGLqqrdRrsPL7fQ6PB9pmbIWjFzXqxenPZDaGpn6q\u002BuJnSdJBmCcOcTuJzPhaQedEvmIHV6v0ReoomDAneLb\u002B9v3ZA16U8yk4YW5G57h38Ej/s6FiBNfIGpMCuTt1HSeQAyyORDkDu2hdZHc0DfnIbEkcPaKxI\u002BLiQnOk7EK/VZfW5xW72x7qKWP5J6gJ0QXjm7MMm1wmMvqZX7G2NkSeTOHmE7GDmRsFzxv7HyT2ouBkHfOOnF2Z9vfme1VuSHp6v2NH5bCBLg0/hUNj6HE7GzjjKgatf3sdbfVr9wW3kMdtqhluUGekpF4KLnPEH4WE9VALUtfQQSHxn1EJMgBcsCAwEAAaNQME4wHQYDVR0OBBYEFJCVIW7JjkD/brrrXDwPqhLq8sD8MB8GA1UdIwQYMBaAFJCVIW7JjkD/brrrXDwPqhLq8sD8MAwGA1UdEwQFMAMBAf8wDQYJKoZIhvcNAQELBQADggEBAAtNPFuNP\u002BX5xwI9aD3rnsnxnbgJ4QFmOJw56lWtJ7RgUeO6Iqy61sSgGA5HOiSzGcq/VSp6oCG3EeHNJCx9/pW/aRXz9X6E5cYWbrzrkTl61g4M6DjTviIX6lrzSCJvkFUzUDmb9rQ2GPOBex2V0DcfdCsFWqMo6Va0M5dsOuh4ac1oTWT7Xe6MMkxk8NwuW6Mt/E1pRDNM3YAFUTvQdALlhxuv\u002BAun1UOldOoCkeYXbhkvXKuH8ZtsHhO2Rm3sRghRHmUwu2v0xTSjpF5fu2QJIe0zFuYPV7w9b7APre9tPCUHn/XHAhJcX17CCKr8lVqLvaBuHIoiAMcZ5JlLoak="],"alg":"RS256"}]}`

func Test_parse(t *testing.T) {
	key, err := parseJWK(jwkString)
	if err != nil {
		t.Fatal(err)
	}

	c, err := parse(tokenString, key)
	if err != nil {
		t.Fatal(err)
	}

	t.Log(c)
}

func Test_parseJWK(t *testing.T) {
	key, err := parseJWK(jwkString)
	if err != nil {
		t.Fatal(err)
	}
	_ = key
}
